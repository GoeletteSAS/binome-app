<%= turbo_frame_tag "chatroom_content" do %>
  <div class="container chat">
    <h1>Chat with <%= @chatroom.other_user(current_user).last_name %></h1>

    <%= turbo_stream_from @chatroom %>
    <div id="messages" class="messages">
      <% @chatroom.messages.each do |message| %>
        <%= render "messages/message", message: message, user: current_user %>
      <% end %>
    </div>

    <div class="message-form bg-white border-top p-3 sticky-bottom">
      <%= simple_form_for([@chatroom, Message.new], html: {class: "d-flex",
         data: { controller: "reset-form", action: "turbo:submit-end->reset-form#reset" }}, remote: true) do |f| %>
        <div class="d-flex gap-3">
          <%= f.input :content,
              label: false,
              placeholder: "Ã‰crivez un message",
              input_html: {
                class: "form-control",
                style: "min-height: 80px; max-height: 150px; resize: none;",
                rows: 3
              } %>
          <div class="d-flex align-items-end">
            <%= f.button :submit, "Envoyer", class: "btn btn-primary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
